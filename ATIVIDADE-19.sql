CREATE DATABASE EMPRESA;

USE EMPRESA;

CREATE TABLE Funcionario(
	Codigo INT, 
	PrimeiroNome VARCHAR(50),
	SegundoNome VARCHAR(50), 
	UltimoNome VARCHAR(50),
	DataNasci VARCHAR(50), 
	CPF VARCHAR(20), 
	RG VARCHAR(20), 
	Endereco VARCHAR(100), 
	CEP VARCHAR(10),
	Cidade VARCHAR(50), 
	Fone VARCHAR(20), 
	CodigoDepartamento VARCHAR(20) PRIMARY KEY NOT NULL,
	Funcao VARCHAR(20), 
	Salario FLOAT
);

CREATE TABLE Departamento(
	Codigo INT PRIMARY KEY AUTO_INCREMENT, 
	Nome VARCHAR(50),
	Localizacao VARCHAR(50),
	CodigoFuncionarioGerente VARCHAR(10)
);

INSERT INTO FUNCIONARIO VALUES(NULL,"ROBSON","PINHEIRO","PAIVA","1994-08-01","111.111.111-11","2001010010200","RUA DAS FRONTEIRAS 150","61656-300","FORTALEZA","(85) 9 9229-9229", "10125","DESENVOLVEDOR",7500);

INSERT INTO FUNCIONARIO VALUES(NULL,"JOAO","JARED","MORIANCUMER","2000-10-15","110.158.123-10","200301211000","RUA DAS ORQUIDEAS 120","61656-400","FORTALEZA","(85) 9 9889-9559", "10123","PROGRAMADOR",4500);

INSERT INTO FUNCIONARIO VALUES(NULL,"FELINA","COSTA","SOUSA","2002-12-15","811.911.251-20","2012032016982","RUA PEDRO BORGES 300","95687-300","FORTALEZA","(85) 9 8565-9665", "10205","APRENDIZ",900);

INSERT INTO FUNCIONARIOS VALUES(NULL,"MARIA","EDUARDA","COSTA","2012-03-10","596.452.026-00","3025145685960","RUA 23 D MAIO 150","56987-256","FORTALEZA","(85) 9 8565-7854", "10205","APRENDIZ",900);

INSERT INTO FUNCIONARIO VALUES(NULL,"NIELE","CARNEIRO","SANTOS","1993-08-15","258.852.987-11","0265365914580","RUA DOS OLABAMAS 1150","64585-956","FORTALEZA","(85) 9 9458-9138", "10123","ADMINISTRATIVA",3500);

INSERT INTO FUNCIONARIO VALUES(NULL,"EMANUEL","MARCONDES","ANDRE","1993-08-15","258.852.987-11","0265365914580","RUA DOS OLABAMAS 1150","64585-956","FORTALEZA","(85) 9 9458-9138", "10123","GERENTE",8698.65);

INSERT INTO FUNCIONARIO VALUES(NULL,"MARCELO","JANUARIO","BORGES","1993-08-15","258.852.987-11","0265365914580","RUA DOS OLABAMAS 1150","64585-956","FORTALEZA","(85) 9 9458-9138", "10123","GERENTE",6000);

INSERT INTO FUNCIONARIO VALUES(NULL,"MARIA","JANUARIO","PIERRI","1993-08-15","258.852.987-11","0265365914580","RUA DOS OLABAMAS 1150","64585-956","RECIFE","(85) 9 9458-9138", "10123","TELEFONISTA",9000);

INSERT INTO FUNCIONARIO VALUES(NULL,"PALOMA","JANUARIO","JANUARIO","1993-08-15","258.852.987-11","0265365914580","RUA DOS OLABAMAS 1150","64585-956","FORTALEZA","(85) 9 9458-9138", "10123","TELEFONISTA",9000);

INSERT INTO DEPARTAMENTO VALUES(NULL,"TI","FORTALEZA");
INSERT INTO DEPARTAMENTO VALUES(NULL,"DEPARTAMENTO PESSOAL","FORTALEZA");
INSERT INTO DEPARTAMENTO VALUES(NULL,"LIMPEZA","FORTALEZA","10252");
INSERT INTO DEPARTAMENTO VALUES(NULL,"ADMINISTRATIVO","FORTALEZA","10265");
INSERT INTO DEPARTAMENTO VALUES(NULL,"OPERACIONAL","FORTALEZA","10895");
INSERT INTO DEPARTAMENTO VALUES(NULL,"GERENCIA","FORTALEZA","10256");

1. Liste o nome e o departamento de todos os funcionários que ganham mais do que algum gerente.

SELECT F.PrimeiroNome, D.Nome
FROM Funcionario F JOIN Departamento D
ON F.CodigoDepartamento = D.Codigo
WHERE F.Salario > SOME (
SELECT Salario
FROM Funcionario
WHERE Codigo IN (
SELECT CodigoFuncionarioGerente
FROM Departamento ) );

2. Liste o nome do departamento e do funcionário ordenados por departamento e funcionário.

SELECT  NOME, primeiroNome FROM DEPARTAMENTO
INNER JOIN FUNCIONARIO
ON codigoDepartamento = codigoFuncionarioGerente
ORDER BY NOME,primeiroNome ASC;

3. Liste o menor salário pago pela empresa em cada departamento.
SELECT D.Nome, MIN(F.Salario)
FROM Funcionario F 
INNER JOIN Departamento D
ON F.CodigoDepartamento = D.Codigo
GROUP BY D.Nome;

4. Liste os departamentos dos funcionários que têm a função de supervisor.

SELECT D.Nome, F.PrimeiroNome
FROM Departamento D 
INNER JOIN Funcionario F
ON D.Codigo = F.CodigoDepartamento
WHERE F.Funcao = ‘Supervisor’;
5.  Liste o valor da folha de pagamento de cada departamento (nome).

SELECT D.Nome, SUM(F.Salario) AS Total
FROM Departamento D 
INNER JOIN Funcionario F
ON D.Codigo = F.CodigoDepartamento;

6. Liste todos departamentos com seus respectivos gerentes.

SELECT D.Nome, F.PrimeiroNome
FROM Departamento D 
INNER JOIN Funcionario F
ON D.CodigoFuncionarioGerente = F.Codigo;

7. Liste o nome, o nome do departamento e a função de todos os funcionários.
SELECT F.PrimeiroNome, D.Nome,F.Funcao
FROM Funcionario F 
INNER JOIN Departamento D
ON F.CodigoDepartamento = D.Codigo;
